# Планы развития программы (дорожная карта)

## План развития аналитического функционала программы

Уровень 1: Выполнение команд
- [x] Простое предложение с прямым порядком слов, если сказуемое в повелительном наклонении
- [x] Функция возвращает результат
- [x] Поддержка синонимии/антонимии у глаголов (позволяет в одной функции реализовать два противоположных действия)
- [x] Поддержка числительных независимо от склонения, рода и части речи
- [x] Поддержка простых математических глаголов (сложение, умножение)
- [ ] Распознавание несловесных сущностей: `Найди на странице http://example.com элементы ".menu item"`

Уровень 2: Обусловленное выполнение команд
- [ ] Условия (если ..., то ...)
- [ ] Циклы (пока ..., делай ...)
- [ ] Обстоятельства (места, времени, периодичности, прочие)
- [ ] На основе обстоятельств реализовать планировщик задач (аналог Cron)
- [ ] Функция может отправлять результат в любое время

Уровень 3: Наполнение базы через ведение диалога на естественном языке
- [ ] Добавление семантических отношений (синонимов, антонимов, гиперонимов)
- [ ] Добавление новых функций
- [ ] Изменение настроек программы

## План развития общего функционала программы

- [x] Написание ФАСИФА 3.0 - формата и алгоритма ассоциирования лингвистической информации с функцией и её аргументами.  
- [x] Написание базы семантических отношений
- [x] Параллельный запуск интерфейсных модулей
- [x] Отдельные настройки дл каждого интерфейсного модуля
- [x] Добавить модуль "Message", предоставляющий комфортный доступ к настройкам, функциям интерфейсного модуля, анализам на всех уровнях обработки предложений
- [x] Добавить логирующие модули, которым модуль "Message" передаёт данные анализов всех уровней
- [x] Реализовать 3 варианта ответных данных: действительные (из реальных источников: датчики, интернет-сервисы), мнимые (фейковые данные для тестирования), конструкционные (например, сумма чисел 2 и 4 будет показана как "2 + 4", а не 6"; удобно отслеживать логику работы программы)
- [ ] Юнит-тесты для каждого уровня анализа, а также для отдельных функций
- [ ] Тесты для проверки работоспособности интерфейсных модулей
- [ ] Тесты для ФАСИФов: assert Ф. найденный для словосочетания, Ф. должный
- [ ] Написать установщик, который позволит запускать из консоли скрипты на Эсперато: `./esperanto_text.txt` или `manspy esperanto_text.txt`
- [ ] Реализовать веб API
- [ ] Добавить программу в PIP-репозиторий (чтобы установка была возможна через `pip install manspy`)
- [ ] Написать локальный сервер для отображения в реальном времени статистики заполнения базы и диалога программы с пользователем. Данные сервера берёт из базы, которую заолняет один из логирующх модулей 
- [ ] Подключить переводчик на Эсперанто для общения с ManSPy на русском и английском языках.
- [ ] Подключение программы к виртуальному пространству для тестирования: городская инфраструктура, экономика, умные дома, роботы (андроиды и транспорт), производственные предприятия

## План развития синтетического функционала программы

- [ ] Примитивный синтез текста через подстановку ответа функции в текст вопроса

# Иной взгляд на структуру и восприятие предложения

## Поверхностное описание

*Простое предложение* состоит из:
- *подлежащего*
- *сказуемого*
- *прямого и косвенных дополнения*, они же актанты глагола. *Дополнения* входят сюда же
- *обстоятельств*

*Сложное предложения* - это набор простых предложений, имеющих *сочинительную* или *подчинительную* связь.
*Текст* - это список простых предложений, исполняемых последовательно.

*Простые предложения* в *тексте* между собой могут иметь *сочинительную* либо *подчинительную* связь. Некоторые виды *подчинительной связи* (*условие* и *цикл*) обуславливают исполнение предложений. Уже только благодаря этому можно предположить, что текст - это своего рода компьютерная программа на естественном языке. 

### Подробнее о предложениях

Некоторые актанты имеют состояние, для некоторых актантов пользователь может менять состояние. Таким образом с каждым конкретным актантом ассоциированы две функции: получающие и меняющие (необязательно) его состояние. Функция, изменяющая состояние, ассоциирована также и с соответствующим глаголом.

Глаголы делятся на два типа:
1. принимающие состояния актантов (`montr`, `adici`, `multig`) - у актантов вызываются функции получения их состояния, затем состояния передаются в функцию глагола. Таким образом с каждым таким глаголом ассоциирована одна функция
1. изменяющие состояние актантов (`ŝalt`) - у актантов вызывается функция, меняющая состояние

Общий алгоритм выполнения предложений с глаголом первого типа таков:
1. Находим функции, ассоциированные с каждым актантом
1. Находим функции, ассоциированные с глаголом
1. Выполняем функции актантов, сохраняем возвращаемые ими значения
1. Выполняем функцию глагола, передавая в качестве аргументов значения функций актантов

и второго типа:
1. Находим функцию, ассоциированную с комбинацией глагола и актанта.
1. Вызываем функцию, передавая ей в качестве аргумента *аргументные слова* из актанта

Вызов функции моментально произойдёт только:
- если в предложении отсутствуют обстоятельства, откладывающие его выполнение,
- и глагол находится в повелительном наклонении

Каждый актант имеет *аргументные* и *константные слова*. *Аргументные слова* передаются в функцию получения/изменения состояния, могут быть *обязательными* и *необязательными*.

## Разбор структуры конкретных предложений

**Рассмотрим простые предложения**, состоящие из сказуемого-глагола и его актантов (прямых и косвенных дополнений). 

*Пожалуйста, нажмите на пример предложения, чтобы посмотреть результат его выполнения "вживую"*

### [montru kvardek kvin](https://syeysk.ru/api/manspy/run_get?s=montru%20kvardek%20kvin)

- `kvardek kvin` - актант, его состояние равно `45`
- `montru` - глагол 1-го типа, функция которого примет число <span>`45`</span> в качестве аргумента. Его она и выведет.

### [montru dolaran kurzon de rusia banko](https://syeysk.ru/api/manspy/run_get?s=montru%20dolaran%20kurzon%20de%20rusia%20banko)

- `dolaran kurzon de rusia banko` - актант, его состояние равно `60`
- `montru` - глагол 1-го типа, функция которого примет число <span>`60`</span> в качестве аргумента. Его она и выведет.

### [montru kvardek kvin kaj dolaran kurzon de rusia banko](https://syeysk.ru/api/manspy/run_get?s=montru%20kvardek%20kvin%20kaj%20dolaran%20kurzon%20de%20rusia%20banko)

- `kvardek kvin` - актант, его состояние равно `45`
- `dolaran kurzon de rusia banko` - актант, его состояние равно `60`
- `montru` - глагол 1-го типа, функция которого примет два числа: <span>`45`</span> и <span>`60`</span> в качестве аргументов. Их она и выведет.

### [adiciu kvardek kvin kaj dolaran kurzon de rusia banko](https://syeysk.ru/api/manspy/run_get?s=adiciu%20kvardek%20kvin%20kaj%20dolaran%20kurzon%20de%20rusia%20banko)

- `kvardek kvin` - актант, его состояние равно `45`
- `dolaran kurzon de rusia banko` - актант, его состояние равно `60`
- `adiciu` - глагол 1-го типа, функция которого примет два числа: `45` и `60` в качестве аргументов. Выведет их сумму - <span>`105`</span>.

### [malmultigu dolaran kurzon de rusia banko kaj kvin](https://syeysk.ru/api/manspy/run_get?s=malmultigu%20dolaran%20kurzon%20de%20rusia%20banko%20kaj%20kvin)

- `dolaran kurzon de rusia banko` - актант, его состояние равно `60`
- `kvin` - актант, его состояние равно `5`
- `multigu` - глагол 1-го типа (с приставкой `mal`), функция которого примет два числа: `60` и `5` в качестве аргументов. Вывела бы их произведение, но так как глагол употреблён с отрицательной приставкой, то функция выведет их частное - <span class='off-example'>`12`</span>.

Кстати, в словосочетании `dolaran kurzon de rusia banko` слова `rusia` и `dolaran` являются аргументными, и вместо них допустимо указывать и другие названия стран и валют, например: `montru eŭran kurzon de ukrainia banko` ([проверить](https://syeysk.ru/api/manspy/run_get?s=montru%20euxran%20kurzon%20de%20ukrainia%20banko)).
Причём аргумент банка необязателен, его значение по-умолчанию - это `rusia`, таким образом достаточно написать `montru ukrainian kurzon`, чтобы узнать курс гривны ЦБ РФ ([проверить](https://syeysk.ru/api/manspy/run_get?s=montru%20ukrainian%20kurzon)).
А слово `banko` - константное, его менять недопустимо. Если его изменить, то получится словосочетание, которое может быть ассоциировано с совсем другой функцией

Продолжаем разбор структуры...

### ŝaltu tablan lampon en dormcxambro

# Нерешённые проблемы

## 1

Обстоятельства, выраженные существительным, распознаются как косвенные дополнения.

### Вероятное решение
 
Вручную помечать, какие словосочетания распознавать как обстоятельства.
Идеальный вариант решения - учитывать контекст и смысл слов.

## 2

В предложении `malmultigu dolaran kurzon de rusia banko kaj kvin` слово `kvin` распознаётся как косвенное дополнение, однородное с `banko`, следовательно, ответ программы - 60.
В то время как в предложении `malmultigu dolaran kurzon kaj kvin` слово `kvin` распознаётся как прямое дополнение, однородное с `kurzon`, следовательно, ответ - 12.

### Вероятное решение

В первом случае проверять, есть ли ФАСИФ для словосочетания, подставляя однородные члены на место каждого существительно в словосочетании. Если нет, то `kvin` расценивать как отдельное словосочетание.
Порядок подстановки для выделения второго словосочетания:
- `dolaran kurzon de kvin` - однородное существительное с отбрасываением определений (косвенное дополнение)
- `kvin` - однородное существительное с отбрасываением косвенных дополнений (прямое дополнение)

В случае же `malmultigu dolaran kurzon de rusiaj banko kaj kvin` очевидно присутствие однозначного варианта для второго словосочетания: `dolaran kurzon de rusia kvin` (за счёт употребеления прилагательного во множественном числе)